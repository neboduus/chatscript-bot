0     
PLAN: ^ferryoneload 3 4 879 stockpile.top
" all " 00t u: ( ) $$vehicle = null `02& u: BPICKLOCALVEHICLE ( ^query ( direct_vo ? vehicle ^0 -1 ? @6 ) ) $$at = ^0 $$tmp = ^first ( @6subject ) ^if 00B( ! ^can_travel ( $$tmp ^0 ^2 ) ) 00q{ ^fail ( rule ) } 00J else ( 1 ) 00t { $$vehicle = $$tmp } 004 `04Q u: CPICKREMOTEVEHICLE ( !$$vehicle ^query ( direct_v ? vehicle ? -1 ? @4 ) ) $$vehicle = ^first ( @4subject ) ^query ( direct_sv $$vehicle vehicle ? 1 ) $$at = @0object ^if 00H( ! ^can_travel ( $$vehicle $$at ^0 ) ) 00H{ $$vehicle = null ^fail ( rule ) } 004 ^if 00F( ! ^can_travel ( $$vehicle ^0 ^2 ) ) 00H{ $$vehicle = null ^fail ( rule ) } 004 `03E u: <USEVEHICLE ( $$vehicle ) ^if 00i( $$at != ^0 ) 00L{ ^move_vehicle ( $$vehicle $$at ^0 ) } 004 ^unload_all_but ( $$vehicle $$at ^1 ) ^load_cargo ( $$vehicle ^0 ^1 1000 ) ^move_vehicle ( $$vehicle ^0 ^2 ) ^unload_cargo ( $$vehicle ^2 ^1 1000 ) ^end ( plan ) `000 
PLAN: ^acquire 3 4 1185 stockpile.top
" all " 010 u: >ALREADY_GOOD ( ^has_desired_resource ( ^1 ^0 ^2 ) ) ^end ( plan ) `04a u: EDUMP_ONSITE_VEHICLE ( ^query ( direct_vo ? vehicle ^0 -1 ? @4 ) ) ^loop ( -1 ) 02- { $$vehicle = ^first ( @4subject ) ^if 00H( ^has_some_resource ( $$vehicle ^1 ) ) 01X{ ^unload_cargo ( $$vehicle ^0 ^1 100000 ) ^query ( direct_sv ^0 ^1 ? 1 ) ^if 00m( @0object >= ^2 ) 00p{ ^end ( plan ) } 004 } 004 } `05B u: FDUMP_OFFSITE_VEHICLE ( ) ^loop ( -1 ) 04# { $$vehicle = ^iterator ( ?? member ~vehiclekinds ) ^if 00H( ^has_some_resource ( $$vehicle ^1 ) ) 03z{ ^query ( direct_sv $$vehicle vehicle ? ) $$at = @0object ^if 00i( $$at != ^0 ) 02k{ ^move_vehicle ( $$vehicle $$at ^0 ) ^unload_cargo ( $$vehicle ^0 ^1 100000 ) ^query ( direct_sv ^0 ^1 ? 1 ) ^if 00m( @0object >= ^2 ) 00p{ ^end ( plan ) } 004 } 004 } 004 } `04= u: BFERRY_FROM_PLACE ( ) ^loop ( -1 ) 04v { $$place = ^iterator ( ?? member ~places ) ^loop ( -1 ) 03H { ^if 00l( $$place == ^0 ) 00q{ ^fail ( RULE ) } 02! else 00F( ^has_some_resource ( $$place ^1 ) ) 01O{ ^ferryoneload ( $$place ^1 ^0 ) ^query ( direct_sv ^0 ^1 ? 1 ) ^if 00m( @0object >= ^2 ) 00p{ ^end ( plan ) } 004 } 00G else ( 1 ) 00q { ^fail ( RULE ) } 004 } } `000 
